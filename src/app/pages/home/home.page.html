<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>VibeFlow</ion-title>
    <ion-buttons slot="end">
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-refresher slot="fixed" (ionRefresh)="refreshRecentlyPlayed($event)">
    <ion-refresher-content
      pullingIcon="chevron-down-circle-outline"
      pullingText="Pull to refresh"
      refreshingSpinner="circles"
      refreshingText="Refreshing...">
    </ion-refresher-content>
  </ion-refresher>
  

  <div class="content-container">
    
    <h2>Recently Added</h2>
    <section class="music-section" *ngIf="recentlyPlayed && recentlyPlayed.length > 0">
      <div class="horizontal-scroll">
        <div class="track-card" *ngFor="let track of recentlyPlayed" (click)="playTrack(track)">
          <div class="album-art">
            <img [src]="track.artwork || track.imageUrl || 'assets/placeholder-album.png'" alt="Album Art">
          </div>
          <div class="track-info">           
            <div class="title">{{ track.title }}</div>
            <div class="artist">{{ track.artist }}</div>
          </div>
        </div>
      </div>
    </section>
      <!-- Empty state for when there are no recently played tracks -->
    <section class="music-section" *ngIf="!recentlyPlayed || recentlyPlayed.length === 0">
      <div class="empty-state">
        <ion-icon name="time-outline"></ion-icon>
        <h3>No Playback History</h3>
        <p>Start by playing some music to build your history</p>
        <ion-button fill="clear" (click)="navigateToSearch()">
          <ion-icon slot="start" name="search"></ion-icon>
          Find Music
        </ion-button>
        <ion-button fill="clear" (click)="refreshRecentlyPlayed()">
          <ion-icon slot="start" name="refresh"></ion-icon>
          Refresh History
        </ion-button>
      </div>
    </section>

  <h2>Your Playlists</h2>
    <section class="music-section" *ngIf="playlists && playlists.length > 0">
      <div class="playlists-grid">
        <div class="playlist-card" *ngFor="let playlist of playlists" (click)="openPlaylist(playlist)">
          <div class="playlist-art">
            <img [src]="playlist.coverArt || getFirstTrackArtwork(playlist)" alt="Playlist Art">
          </div>
          <div class="playlist-info">
            <div class="title">{{ playlist.name }}</div>
            <div class="tracks-count">{{ playlist.trackIds.length }} tracks</div>
          </div>
        </div>
      </div>
    </section>
    <br><br><br><br>
  </div>
</ion-content>
