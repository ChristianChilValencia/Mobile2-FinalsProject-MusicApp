<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>VibeFlow</ion-title>
    <ion-buttons slot="end">
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-refresher slot="fixed" (ionRefresh)="refreshRecentlyPlayed($event)">
    <ion-refresher-content
      pullingIcon="chevron-down-circle-outline"
      pullingText="Pull to refresh"
      refreshingSpinner="circles"
      refreshingText="Refreshing...">
    </ion-refresher-content>
  </ion-refresher>

  <div class="content-container">
  
    <!-- <h2>Recently Added</h2> -->
    <h2>Your Playlists</h2>
    <!-- <section class="music-section" *ngIf="recentlyPlayed && recentlyPlayed.length > 0"> -->
    <section class="music-section" *ngIf="playlists && playlists.length > 0">
      <div class="horizontal-scroll">
        <!-- <div class="track-card" *ngFor="let track of recentlyPlayed" (click)="playTrack(track)"> -->
        <div class="track-card" *ngFor="let playlist of playlists" (click)="openPlaylist(playlist)">
          <div class="album-art">
            <!-- <img [src]="track.artwork || track.imageUrl || 'assets/placeholder-album.png'" alt="Album Art"> -->
            <img [src]="playlist.coverArt || getFirstTrackArtwork(playlist)" alt="Playlist Art">
          </div>
          <!-- <div class="track-info">           
            <div class="title">{{ track.title }}</div>
            <div class="artist">{{ track.artist }}</div>
          </div> -->
          <div class="playlist-info">
            <div class="title">{{ playlist.name }}</div>
            <div class="tracks-count">{{ playlist.trackIds.length }} tracks</div>
          </div>

        </div>
      </div>
    </section>

    <section class="music-section" *ngIf="!recentlyPlayed || recentlyPlayed.length === 0">
      <div class="empty-state">
        <ion-icon name="time-outline"></ion-icon>
        <h3>No Playlist Yet</h3>
        <p>Go find some bangers and add them to your own personal playlist</p>
        <ion-button fill="clear" (click)="navigateToSearch()">
          <ion-icon slot="start" name="search"></ion-icon>
          Find Music
        </ion-button>
      </div>
    </section>    <ion-list-header>
      <ion-label>Trending Tracks</ion-label>
      <ion-button fill="clear" size="small" (click)="loadTrendingTracks()" *ngIf="!loadingTrending">
        <ion-icon name="refresh-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-list-header>
    <section class="music-section">      <div *ngIf="loadingTrending" class="status-message">
        <ion-spinner name="dots"></ion-spinner>
        <p>Loading trending tracks...</p>
      </div>
      
      <div *ngIf="trendingError" class="status-message">
        <ion-icon name="alert-circle-outline"></ion-icon>
        <p>Could not load trending tracks</p>
        <ion-button fill="clear" (click)="loadTrendingTracks()">
          <ion-icon slot="start" name="refresh"></ion-icon>
          Retry
        </ion-button>
      </div><ion-list *ngIf="!loadingTrending && !trendingError && trendingTracks.length > 0" class="trending-list">
        <ion-item *ngFor="let track of trendingTracks" (click)="playTrendingTrack(track)" button detail="false">
          <ion-thumbnail slot="start">
            <img [src]="track.album.cover_medium || 'assets/placeholder-album.png'" alt="Album Art">
          </ion-thumbnail>
          <ion-label>
            <h2>{{ track.title }}</h2>
            <h3>{{ track.artist.name }}</h3>
            <p *ngIf="track.album?.title">{{ track.album.title }}</p>
          </ion-label>        
          <div class="item-actions" slot="end">
            <ion-button fill="clear" (click)="playTrendingTrack(track); $event.stopPropagation()">
              <ion-icon slot="icon-only" name="play"></ion-icon>
            </ion-button>
            <ion-button fill="clear" (click)="addTrackToPlaylist(track); $event.stopPropagation()">
              <ion-icon slot="icon-only" name="add"></ion-icon>
            </ion-button>
          </div>
        </ion-item>
      </ion-list>      <div *ngIf="!loadingTrending && !trendingError && trendingTracks.length === 0" class="status-message">
        <ion-icon name="musical-notes-outline"></ion-icon>
        <p>No trending tracks available</p>
      </div>
    </section>
    <br><br><br><br>
  </div>
</ion-content>
